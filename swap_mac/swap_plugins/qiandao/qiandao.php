<?php  defined('SWAP_ROOT') or die('非法操作'); function qiandao_config(){ $config['swap_plug']='签到插件'; $config['swap_plug_version']='1.0'; $config['swap_plug_explain']=<<<SWAP
用于客户签到进行奖励
SWAP;
 $config['swap_plug_author']='施健'; $config['swap_plug_website']=''; return $config; } function qd_duibiday(){ $OSWAP_0b6b290fe896f650d5a48d3f7563beb6=session("uid"); $OSWAP_0b6b290fe896f650d5a48d3f7563beb6=(int)$OSWAP_0b6b290fe896f650d5a48d3f7563beb6; if($OSWAP_0b6b290fe896f650d5a48d3f7563beb6<=0) return true; $OSWAP_f998f374c86060c2ab9c4b1294f070cf=plug_eva('qiandao',"上次签到时间[{$OSWAP_0b6b290fe896f650d5a48d3f7563beb6}]"); $OSWAP_f998f374c86060c2ab9c4b1294f070cf=str_replace("-","",$OSWAP_f998f374c86060c2ab9c4b1294f070cf); $OSWAP_f998f374c86060c2ab9c4b1294f070cf=(int)$OSWAP_f998f374c86060c2ab9c4b1294f070cf; if($OSWAP_f998f374c86060c2ab9c4b1294f070cf<1) return false; if(date('Ymd')>$OSWAP_f998f374c86060c2ab9c4b1294f070cf) return false; return true; } function qd_w(){ $OSWAP_0b6b290fe896f650d5a48d3f7563beb6=session("uid"); plug_eva('qiandao',"上次签到时间[{$OSWAP_0b6b290fe896f650d5a48d3f7563beb6}]",date('Ymd')); } function qd_pd(){ $OSWAP_07bd6c93d07da2f4f6fcd759e7dae4b5=plug_eva('qiandao','可签到时间段'); $o=explode('-',$OSWAP_07bd6c93d07da2f4f6fcd759e7dae4b5); if($o[0]=='') return '已开始'; if($o[1]=='') return '已开始'; $OSWAP_70eb0f9aedad2ac1c2c550a003d31615=$o[0]; $OSWAP_bc5979da7d3f1c1d19c4bd6fee5df5d0=$o[1]; $OSWAP_e3ef33eacdf901b189bb84d8738eb645=date('H:i'); if($OSWAP_e3ef33eacdf901b189bb84d8738eb645<$OSWAP_70eb0f9aedad2ac1c2c550a003d31615) return "未开始"; if($OSWAP_e3ef33eacdf901b189bb84d8738eb645>$OSWAP_bc5979da7d3f1c1d19c4bd6fee5df5d0) return "已结束"; return '已开始'; } function qd_je($a=0){ $o=explode('-',plug_eva('qiandao','赠送金额范围')); $OSWAP_bd6208c5b762312608b1f50c20a40fa4=$o[0]; $OSWAP_e3d4e62eb25c886055b03fa083092da3=$o[1]; $OSWAP_a1cd1cd5f9ccd71462738a65d63fad87=$OSWAP_bd6208c5b762312608b1f50c20a40fa4; if($OSWAP_e3d4e62eb25c886055b03fa083092da3!="" && $a==0) $OSWAP_a1cd1cd5f9ccd71462738a65d63fad87=rand($OSWAP_bd6208c5b762312608b1f50c20a40fa4,$OSWAP_e3d4e62eb25c886055b03fa083092da3); if($OSWAP_e3d4e62eb25c886055b03fa083092da3!="" && $a==1) $OSWAP_a1cd1cd5f9ccd71462738a65d63fad87="随机"; return $OSWAP_a1cd1cd5f9ccd71462738a65d63fad87; } function qd_dayyesqd(){ $OSWAP_87d139fd812d3574355a46dfb0009c9a=plug_eva('qiandao','可签到时间'); $OSWAP_ca51124348e5f7ad98d300b1a88d516c=explode(',',$OSWAP_87d139fd812d3574355a46dfb0009c9a); return in_array(date("w"), $OSWAP_ca51124348e5f7ad98d300b1a88d516c); } function qiandao() { $lang=plug_lang_get('qiandao',"index"); $OSWAP_60e21537ace5f2966d7d88a62ce993af=0; $OSWAP_a1cd1cd5f9ccd71462738a65d63fad87=qd_je(1); $OSWAP_0b6b290fe896f650d5a48d3f7563beb6=session("uid"); if(qd_duibiday()) $OSWAP_60e21537ace5f2966d7d88a62ce993af=1; if(!qd_dayyesqd() && $OSWAP_60e21537ace5f2966d7d88a62ce993af==0) $OSWAP_60e21537ace5f2966d7d88a62ce993af=2; $OSWAP_4deb23ca54cc4a01412e3d63533a10eb=qd_pd(); if($OSWAP_4deb23ca54cc4a01412e3d63533a10eb=="未开始" && $OSWAP_60e21537ace5f2966d7d88a62ce993af==0) $OSWAP_60e21537ace5f2966d7d88a62ce993af=3; if($OSWAP_4deb23ca54cc4a01412e3d63533a10eb=="已结束" && $OSWAP_60e21537ace5f2966d7d88a62ce993af==0) $OSWAP_60e21537ace5f2966d7d88a62ce993af=4; $OSWAP_334b1f190d48cd212fe63de9c7d82089[0]=''; $OSWAP_334b1f190d48cd212fe63de9c7d82089[1]=$lang['今日已经签到不能重复签到']; $OSWAP_334b1f190d48cd212fe63de9c7d82089[2]=$lang['今日不可签到']; $OSWAP_334b1f190d48cd212fe63de9c7d82089[3]=$lang['签到时间还未开始']; $OSWAP_334b1f190d48cd212fe63de9c7d82089[4]=$lang['签到时间已经结束']; $OSWAP_2face49914e4a262071ad4b61324b064=$OSWAP_334b1f190d48cd212fe63de9c7d82089[$OSWAP_60e21537ace5f2966d7d88a62ce993af]; $t['err']=$OSWAP_334b1f190d48cd212fe63de9c7d82089[$OSWAP_60e21537ace5f2966d7d88a62ce993af]; $t['lang']=$lang; $t['jeecho']=$OSWAP_a1cd1cd5f9ccd71462738a65d63fad87; TEMPLATE::assign('t',$t); TEMPLATE::display(SWAP_PLUGINS.'qiandao/templates/index.tpl'); } add_swap_plug("预存款列表","qiandao"); function qiandao_template(){ $ur=plug_eva('qiandao','提示返回跳转地址'); if($ur=='')return ''; $lang=plug_lang_get('qiandao',"index"); $OSWAP_60e21537ace5f2966d7d88a62ce993af=0; $OSWAP_a1cd1cd5f9ccd71462738a65d63fad87=qd_je(1); $OSWAP_0b6b290fe896f650d5a48d3f7563beb6=session("uid"); if(qd_duibiday()) $OSWAP_60e21537ace5f2966d7d88a62ce993af=1; if(!qd_dayyesqd() && $OSWAP_60e21537ace5f2966d7d88a62ce993af==0) $OSWAP_60e21537ace5f2966d7d88a62ce993af=2; $OSWAP_4deb23ca54cc4a01412e3d63533a10eb=qd_pd(); if($OSWAP_4deb23ca54cc4a01412e3d63533a10eb=="未开始" && $OSWAP_60e21537ace5f2966d7d88a62ce993af==0) $OSWAP_60e21537ace5f2966d7d88a62ce993af=3; if($OSWAP_4deb23ca54cc4a01412e3d63533a10eb=="已结束" && $OSWAP_60e21537ace5f2966d7d88a62ce993af==0) $OSWAP_60e21537ace5f2966d7d88a62ce993af=4; $OSWAP_334b1f190d48cd212fe63de9c7d82089[0]=''; $OSWAP_334b1f190d48cd212fe63de9c7d82089[1]=$lang['今日已经签到不能重复签到']; $OSWAP_334b1f190d48cd212fe63de9c7d82089[2]=$lang['今日不可签到']; $OSWAP_334b1f190d48cd212fe63de9c7d82089[3]=$lang['签到时间还未开始']; $OSWAP_334b1f190d48cd212fe63de9c7d82089[4]=$lang['签到时间已经结束']; $OSWAP_2face49914e4a262071ad4b61324b064=$OSWAP_334b1f190d48cd212fe63de9c7d82089[$OSWAP_60e21537ace5f2966d7d88a62ce993af]; $t['err']=$OSWAP_334b1f190d48cd212fe63de9c7d82089[$OSWAP_60e21537ace5f2966d7d88a62ce993af]; $t['lang']=$lang; $t['jeecho']=$OSWAP_a1cd1cd5f9ccd71462738a65d63fad87; TEMPLATE::assign("cjblapi_qiandao",$t); } add_swap_plug('HEAD区域','qiandao_template'); function qiandao_adminlb(&$OSWAP_16706e96fc1a08cf93c1f57287814cd7){ $OSWAP_16706e96fc1a08cf93c1f57287814cd7[]=array('name'=>'签到设置','link'=>'/index.php/plugin/qiandao/admin/'); } add_swap_plug('管理员菜单列表','qiandao_adminlb'); 