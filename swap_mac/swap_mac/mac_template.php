<?php  defined('SWAP_ROOT') or die('非法操作'); $GLOBALS['swap_mac']['config']['templates']=require(SWAP_CONFIGS.'template.php'); if(_GET('template')!=''){ $GLOBALS['swap_mac']['config']['templates']['template']=_GET('template'); } if(!file_exists(SWAP_TEMPLATES.$GLOBALS['swap_mac']['config']['templates']['template'])){ $GLOBALS['swap_mac']['config']['templates']['template']='default'; file_exists(SWAP_TEMPLATES.$GLOBALS['swap_mac']['config']['templates']['template']) or die(swap_main_error_module('无法加载模版包',$GLOBALS['swap_mac']['config']['templates']['template'])); } define('SWAP_TEMPLATES_ROOT',SWAP_TEMPLATES.$GLOBALS['swap_mac']['config']['templates']['template']); $GLOBALS['swap_mac']['template'] = T(); TEMPLATE::setConfig('force_compile',$GLOBALS['swap_mac']['config']['templates']['force_compile']); TEMPLATE::setConfig('debugging',$GLOBALS['swap_mac']['config']['templates']['debugging']); TEMPLATE::setConfig('caching',$GLOBALS['swap_mac']['config']['templates']['caching']); TEMPLATE::setConfig('cache_lifetime',$GLOBALS['swap_mac']['config']['templates']['cache_lifetime']); TEMPLATE::assign("template",$GLOBALS['swap_mac']['config']['templates']['template']); TEMPLATE::assign("version",$GLOBALS['swap_mac']['version']); TEMPLATE::assign("templatedir",'/templates/'.$GLOBALS['swap_mac']['config']['templates']['template']); function T(){ return TEMPLATE::M(); } class TEMPLATE { static function M(){ static $template; static $OSWAP_5666769464c361c4f3e552640e762ce6=false; if(!$OSWAP_5666769464c361c4f3e552640e762ce6){ require_once SWAP_LIB . 'Smarty/Smarty.class.php'; $template=new Smarty; $OSWAP_5666769464c361c4f3e552640e762ce6=true; } return $template; } static function setConfig($OSWAP_0d07de59261cc2c9023b194184c575fb,$OSWAP_afd0bcbfee327774d84e48653b578ff9){ self::M()->$OSWAP_0d07de59261cc2c9023b194184c575fb=$OSWAP_afd0bcbfee327774d84e48653b578ff9; return true; } static function assign($OSWAP_0d07de59261cc2c9023b194184c575fb,$OSWAP_63e29f0f36f8e0e4b3ad59487599f02a=false,$qz=true){ if($OSWAP_63e29f0f36f8e0e4b3ad59487599f02a===false){ return self::M()->getTemplateVars($OSWAP_0d07de59261cc2c9023b194184c575fb); } self::M()->assign($OSWAP_0d07de59261cc2c9023b194184c575fb,$OSWAP_63e29f0f36f8e0e4b3ad59487599f02a,true); } static function display($OSWAP_0d07de59261cc2c9023b194184c575fb,$OSWAP_817a79b262c9cf5fca5c9c6f5ca60152=false,$OSWAP_fd3294d3be61b407cae98b089032c0e4=''){ if(file_exists(SWAP_ROOT.SWAP_TEMPLATES_ROOT.SWAP_DIR_END.'lib'.SWAP_DIR_END.'main.php')){ require SWAP_ROOT.SWAP_TEMPLATES_ROOT.SWAP_DIR_END.'lib'.SWAP_DIR_END.'main.php'; } if($OSWAP_817a79b262c9cf5fca5c9c6f5ca60152){ if(file_exists(SWAP_TEMPLATES_ROOT.DS.'public'.DS.'lib'.$OSWAP_fd3294d3be61b407cae98b089032c0e4.'.php')): require SWAP_TEMPLATES_ROOT.DS.'public'.DS.'lib'.$OSWAP_fd3294d3be61b407cae98b089032c0e4.'.php'; endif; } unset($lang); if(file_exists(SWAP_ROOT.SWAP_TEMPLATES_ROOT.SWAP_DIR_END.'lib'.SWAP_DIR_END.basename($OSWAP_0d07de59261cc2c9023b194184c575fb,'.tpl').'.php')){ require SWAP_ROOT.SWAP_TEMPLATES_ROOT.SWAP_DIR_END.'lib'.SWAP_DIR_END.basename($OSWAP_0d07de59261cc2c9023b194184c575fb,'.tpl').'.php'; } unset($lang); if(file_exists(SWAP_ROOT.SWAP_TEMPLATES_ROOT.SWAP_DIR_END.'lang'.SWAP_DIR_END.$GLOBALS['swap_mac']['config']['language'].SWAP_DIR_END.basename($OSWAP_0d07de59261cc2c9023b194184c575fb,'.tpl').'.php')){ require SWAP_ROOT.SWAP_TEMPLATES_ROOT.SWAP_DIR_END.'lang'.SWAP_DIR_END.$GLOBALS['swap_mac']['config']['language'].SWAP_DIR_END.basename($OSWAP_0d07de59261cc2c9023b194184c575fb,'.tpl').'.php'; isset($lang)?self::assign("tlang",$lang,true):NULL; }elseif(file_exists(SWAP_ROOT.SWAP_TEMPLATES_ROOT.SWAP_DIR_END.'lang'.SWAP_DIR_END.'Chinese'.SWAP_DIR_END.basename($OSWAP_0d07de59261cc2c9023b194184c575fb,'.tpl').'.php')){ require SWAP_ROOT.SWAP_TEMPLATES_ROOT.SWAP_DIR_END.'lang'.SWAP_DIR_END.'Chinese'.SWAP_DIR_END.basename($OSWAP_0d07de59261cc2c9023b194184c575fb,'.tpl').'.php'; isset($lang)?self::assign("tlang",$lang,true):NULL; } unset($lang); if(file_exists(SWAP_ROOT.SWAP_TEMPLATES_ROOT.SWAP_DIR_END.'lang'.SWAP_DIR_END.$GLOBALS['swap_mac']['config']['language'].SWAP_DIR_END.'main.php')){ require SWAP_ROOT.SWAP_TEMPLATES_ROOT.SWAP_DIR_END.'lang'.SWAP_DIR_END.$GLOBALS['swap_mac']['config']['language'].SWAP_DIR_END.'main.php'; isset($lang)?self::assign("mlang",$lang,true):NULL; }elseif(file_exists(SWAP_ROOT.SWAP_TEMPLATES_ROOT.SWAP_DIR_END.'lang'.SWAP_DIR_END.'Chinese'.SWAP_DIR_END.'main.php')){ require SWAP_ROOT.SWAP_TEMPLATES_ROOT.SWAP_DIR_END.'lang'.SWAP_DIR_END.'Chinese'.SWAP_DIR_END.'main.php'; isset($lang)?self::assign("mlang",$lang,true):NULL; } unset($lang); mac_set_runtime(); if($GLOBALS['swap_mac']['plugin_template']=='1'){ if(file_exists('.'.DS.SWAP_TEMPLATES_ROOT.DS.'plugin'.DS.$GLOBALS['swap_mac']['plugin_template_dir'].DS.$OSWAP_0d07de59261cc2c9023b194184c575fb)){ TEMPLATE::dir('.'.DS.SWAP_TEMPLATES_ROOT.DS.'plugin'.DS.$GLOBALS['swap_mac']['plugin_template_dir'].DS); self::M()->display($OSWAP_0d07de59261cc2c9023b194184c575fb); TEMPLATE::dir(SWAP_PLUGINS.$GLOBALS['swap_mac']['plugin_template_dir'].SWAP_DIR_END.'templates'); }else self::M()->display($OSWAP_0d07de59261cc2c9023b194184c575fb); }else self::M()->display($OSWAP_0d07de59261cc2c9023b194184c575fb); } static function dir($OSWAP_0d07de59261cc2c9023b194184c575fb){ self::M()->setTemplateDir($OSWAP_0d07de59261cc2c9023b194184c575fb); } static function functions($OSWAP_c0ba22d6ae38b4bb617588da4716910c,&$OSWAP_4db1d7a071d4677ef57b5f22e20071c5=NULL,&$OSWAP_8aafe2d2276092530330af42e661bbb5=NULL,&$OSWAP_e9611cf6ba52f56839cbb2f115f7d937=NULL,&$OSWAP_2b7017f3b97b1a5e712f3bf84ab06784=NULL,&$OSWAP_5a8dd6f96cefdc4422aa9229a5a7e0d2=NULL,&$OSWAP_fde787fd898324ba994e4e559f1dba12=NULL,&$OSWAP_8e4f6a3e4f5d0adb99824019e327d740=NULL,&$OSWAP_2d17303bbe05b0feb8187e2e2e13b238=NULL,&$OSWAP_5fd806f5c0cfbce750f99c1dfe2e90fc=NULL,&$OSWAP_ec790f21b1a11c9a39bf95ef50da33af=NULL,&$OSWAP_3ec4cb0bc5577ab47598b49fff0dcad6=NULL,&$OSWAP_af962498daf50d0f1487b2bcf69ebcc0=NULL,&$OSWAP_dc16c46862b9cfe2493da581b30e8fc1=NULL,&$OSWAP_bf11310d662680aaf671da98a7226bf7=NULL,&$OSWAP_d4ef66c199ea39f007728ce0935902fb=NULL,&$OSWAP_d568a155d4066ed8e9cf7d7743f448a3=NULL,&$OSWAP_ca354f4dfcd680f5b1148a915d9dac15=NULL,&$OSWAP_9c24b675538fabf2ac0041ac49010ef4=NULL,&$OSWAP_30d7759afc6ac737bff003d9b00dd607=NULL,&$OSWAP_72eb1a37e49878516e65d546489a83f7=NULL){ $OSWAP_1fbc6e1426739a8c2ebc9fac81922d35=false; if(isset($GLOBALS['swap_mac']['plugin']['controller'])) $OSWAP_c9d6da5fe63048d3e5234df142aa6a2f = call_user_func_array(array($GLOBALS['swap_mac']['plugin']['controller'],$OSWAP_c0ba22d6ae38b4bb617588da4716910c), array(&$OSWAP_4db1d7a071d4677ef57b5f22e20071c5,&$OSWAP_8aafe2d2276092530330af42e661bbb5,&$OSWAP_e9611cf6ba52f56839cbb2f115f7d937,&$OSWAP_2b7017f3b97b1a5e712f3bf84ab06784,&$OSWAP_5a8dd6f96cefdc4422aa9229a5a7e0d2,&$OSWAP_fde787fd898324ba994e4e559f1dba12,&$OSWAP_8e4f6a3e4f5d0adb99824019e327d740,&$OSWAP_2d17303bbe05b0feb8187e2e2e13b238,&$OSWAP_5fd806f5c0cfbce750f99c1dfe2e90fc,&$OSWAP_ec790f21b1a11c9a39bf95ef50da33af,&$OSWAP_3ec4cb0bc5577ab47598b49fff0dcad6,&$OSWAP_af962498daf50d0f1487b2bcf69ebcc0,&$OSWAP_dc16c46862b9cfe2493da581b30e8fc1,&$OSWAP_bf11310d662680aaf671da98a7226bf7,&$OSWAP_d4ef66c199ea39f007728ce0935902fb,&$OSWAP_d568a155d4066ed8e9cf7d7743f448a3,&$OSWAP_ca354f4dfcd680f5b1148a915d9dac15,&$OSWAP_9c24b675538fabf2ac0041ac49010ef4,&$OSWAP_30d7759afc6ac737bff003d9b00dd607,&$OSWAP_72eb1a37e49878516e65d546489a83f7)); else $OSWAP_c9d6da5fe63048d3e5234df142aa6a2f = call_user_func_array(array($GLOBALS['swap_mac']['controller'],$OSWAP_c0ba22d6ae38b4bb617588da4716910c), array(&$OSWAP_4db1d7a071d4677ef57b5f22e20071c5,&$OSWAP_8aafe2d2276092530330af42e661bbb5,&$OSWAP_e9611cf6ba52f56839cbb2f115f7d937,&$OSWAP_2b7017f3b97b1a5e712f3bf84ab06784,&$OSWAP_5a8dd6f96cefdc4422aa9229a5a7e0d2,&$OSWAP_fde787fd898324ba994e4e559f1dba12,&$OSWAP_8e4f6a3e4f5d0adb99824019e327d740,&$OSWAP_2d17303bbe05b0feb8187e2e2e13b238,&$OSWAP_5fd806f5c0cfbce750f99c1dfe2e90fc,&$OSWAP_ec790f21b1a11c9a39bf95ef50da33af,&$OSWAP_3ec4cb0bc5577ab47598b49fff0dcad6,&$OSWAP_af962498daf50d0f1487b2bcf69ebcc0,&$OSWAP_dc16c46862b9cfe2493da581b30e8fc1,&$OSWAP_bf11310d662680aaf671da98a7226bf7,&$OSWAP_d4ef66c199ea39f007728ce0935902fb,&$OSWAP_d568a155d4066ed8e9cf7d7743f448a3,&$OSWAP_ca354f4dfcd680f5b1148a915d9dac15,&$OSWAP_9c24b675538fabf2ac0041ac49010ef4,&$OSWAP_30d7759afc6ac737bff003d9b00dd607,&$OSWAP_72eb1a37e49878516e65d546489a83f7)); if($OSWAP_c9d6da5fe63048d3e5234df142aa6a2f) $OSWAP_1fbc6e1426739a8c2ebc9fac81922d35=true; return $OSWAP_1fbc6e1426739a8c2ebc9fac81922d35; } static function lang(){ if(file_exists(SWAP_ROOT.SWAP_TEMPLATES_ROOT.'/lang/'.$GLOBALS['swap_mac']['config']['language'].'/index.php')){ require SWAP_ROOT.SWAP_TEMPLATES_ROOT.'/lang/'.$GLOBALS['swap_mac']['config']['language'].'/index.php'; }else{ if(file_exists(SWAP_ROOT.SWAP_TEMPLATES_ROOT.'/lang/Chinese/index.php')){ require SWAP_ROOT.SWAP_TEMPLATES_ROOT.'/lang/Chinese/index.php'; }else{ swap_main_error_module('无法找到默认中文语言包',SWAP_TEMPLATES_ROOT); } } return $lang; } } 