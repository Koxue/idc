<?php  defined('SWAP_ROOT') or die('非法操作'); $GLOBALS['swap_mac']['config']['syjweb']=array('switch'=>true,'post'=>true,'get'=>true,'cookie'=>true,'referre'=>true); $GLOBALS['swap_mac']['syjweb']['getfilter'] = "\\<.+javascript:window\\[.{1}\\\\x|<.*=(&#\\d+?;?)+?>|<.*(data|src)=data:text\\/html.*>|\\b(alert\\(|confirm\\(|expression\\(|prompt\\(|benchmark\s*?\(.*\)|sleep\s*?\(.*\)|\\b(group_)?concat[\\s\\/\\*]*?\\([^\\)]+?\\)|\bcase[\s\/\*]*?when[\s\/\*]*?\([^\)]+?\)|load_file\s*?\\()|<[a-z]+?\\b[^>]*?\\bon([a-z]{4,})\s*?=|^\\+\\/v(8|9)|\\b(and|or)\\b\\s*?([\\(\\)'\"\\d]+?=[\\(\\)'\"\\d]+?|[\\(\\)'\"a-zA-Z]+?=[\\(\\)'\"a-zA-Z]+?|>|<|\s+?[\\w]+?\\s+?\\bin\\b\\s*?\(|\\blike\\b\\s+?[\"'])|\\/\\*.*\\*\\/|<\\s*script\\b|\\bEXEC\\b|UNION.+?SELECT\s*(\(.+\)\s*|@{1,2}.+?\s*|\s+?.+?|(`|'|\").*?(`|'|\")\s*)|UPDATE\s*(\(.+\)\s*|@{1,2}.+?\s*|\s+?.+?|(`|'|\").*?(`|'|\")\s*)SET|INSERT\\s+INTO.+?VALUES|(SELECT|DELETE)@{0,2}(\\(.+\\)|\\s+?.+?\\s+?|(`|'|\").*?(`|'|\"))FROM(\\(.+\\)|\\s+?.+?|(`|'|\").*?(`|'|\"))|(CREATE|ALTER|DROP|TRUNCATE)\\s+(TABLE|DATABASE)"; $GLOBALS['swap_mac']['syjweb']['postfilter'] = "<.*=(&#\\d+?;?)+?>|<.*data=data:text\\/html.*>|\\b(alert\\(|confirm\\(|expression\\(|prompt\\(|benchmark\s*?\(.*\)|sleep\s*?\(.*\)|\\b(group_)?concat[\\s\\/\\*]*?\\([^\\)]+?\\)|\bcase[\s\/\*]*?when[\s\/\*]*?\([^\)]+?\)|load_file\s*?\\()|<[^>]*?\\b(onerror|onmousemove|onload|onclick|onmouseover)\\b|\\b(and|or)\\b\\s*?([\\(\\)'\"\\d]+?=[\\(\\)'\"\\d]+?|[\\(\\)'\"a-zA-Z]+?=[\\(\\)'\"a-zA-Z]+?|>|<|\s+?[\\w]+?\\s+?\\bin\\b\\s*?\(|\\blike\\b\\s+?[\"'])|\\/\\*.*\\*\\/|<\\s*script\\b|\\bEXEC\\b|UNION.+?SELECT\s*(\(.+\)\s*|@{1,2}.+?\s*|\s+?.+?|(`|'|\").*?(`|'|\")\s*)|UPDATE\s*(\(.+\)\s*|@{1,2}.+?\s*|\s+?.+?|(`|'|\").*?(`|'|\")\s*)SET|INSERT\\s+INTO.+?VALUES|(SELECT|DELETE)(\\(.+\\)|\\s+?.+?\\s+?|(`|'|\").*?(`|'|\"))FROM(\\(.+\\)|\\s+?.+?|(`|'|\").*?(`|'|\"))|(CREATE|ALTER|DROP|TRUNCATE)\\s+(TABLE|DATABASE)"; $GLOBALS['swap_mac']['syjweb']['cookiefilter'] = "benchmark\s*?\(.*\)|sleep\s*?\(.*\)|load_file\s*?\\(|\\b(and|or)\\b\\s*?([\\(\\)'\"\\d]+?=[\\(\\)'\"\\d]+?|[\\(\\)'\"a-zA-Z]+?=[\\(\\)'\"a-zA-Z]+?|>|<|\s+?[\\w]+?\\s+?\\bin\\b\\s*?\(|\\blike\\b\\s+?[\"'])|\\/\\*.*\\*\\/|<\\s*script\\b|\\bEXEC\\b|UNION.+?SELECT\s*(\(.+\)\s*|@{1,2}.+?\s*|\s+?.+?|(`|'|\").*?(`|'|\")\s*)|UPDATE\s*(\(.+\)\s*|@{1,2}.+?\s*|\s+?.+?|(`|'|\").*?(`|'|\")\s*)SET|INSERT\\s+INTO.+?VALUES|(SELECT|DELETE)@{0,2}(\\(.+\\)|\\s+?.+?\\s+?|(`|'|\").*?(`|'|\"))FROM(\\(.+\\)|\\s+?.+?|(`|'|\").*?(`|'|\"))|(CREATE|ALTER|DROP|TRUNCATE)\\s+(TABLE|DATABASE)"; $GLOBALS['swap_mac']['syjweb']['syjweb_referer'] = empty($_SERVER['HTTP_REFERER']) ? array() : array('HTTP_REFERER'=>$_SERVER['HTTP_REFERER']); $GLOBALS['swap_mac']['syjweb']['phpfilter'] = "[A-Za-z0-9 -~]*<\?[A-Za-z0-9 -~]*\?>*[A-Za-z0-9 -~]+$"; function shtmlspecialchars($OSWAP_c9d6da5fe63048d3e5234df142aa6a2f) { if(is_array($OSWAP_c9d6da5fe63048d3e5234df142aa6a2f)) { foreach($OSWAP_c9d6da5fe63048d3e5234df142aa6a2f as $OSWAP_6291cc79354613208317e7b10b238055 => $OSWAP_63e29f0f36f8e0e4b3ad59487599f02a) { $OSWAP_c9d6da5fe63048d3e5234df142aa6a2f[$OSWAP_6291cc79354613208317e7b10b238055] = shtmlspecialchars($OSWAP_63e29f0f36f8e0e4b3ad59487599f02a); } } else { $OSWAP_c9d6da5fe63048d3e5234df142aa6a2f = preg_replace('/&((#(\d{3,5}|x[a-fA-F0-9]{4})|[a-zA-Z][a-z0-9]{2,5});)/', '&\\1', str_replace(array('&', '"', '<', '>'), array('&', '"', '<', '>'), $OSWAP_c9d6da5fe63048d3e5234df142aa6a2f)); } return $OSWAP_c9d6da5fe63048d3e5234df142aa6a2f; } function compress_html($OSWAP_c9d6da5fe63048d3e5234df142aa6a2f){ $OSWAP_c9d6da5fe63048d3e5234df142aa6a2f=str_replace("\t",'',$OSWAP_c9d6da5fe63048d3e5234df142aa6a2f); $OSWAP_4181de9960036fc2f3c860ec74124a34=array( "/> *([^ ]*) *</", "/<!--[^>]*-->/i", "/\" /", "/ \"/", "'/\*[^*]*\*/'" ); $OSWAP_d54d649f7343488fe1300a13408f333f=array( ">\\1<", "", "\"", "\"", "" ); return preg_replace($OSWAP_4181de9960036fc2f3c860ec74124a34,$OSWAP_d54d649f7343488fe1300a13408f333f,$OSWAP_c9d6da5fe63048d3e5234df142aa6a2f); } function RemoveXSS($OSWAP_b841d8e57855e0dee7a48e5cc871ba76) { $OSWAP_b841d8e57855e0dee7a48e5cc871ba76 = compress_html(stripslashes($OSWAP_b841d8e57855e0dee7a48e5cc871ba76)); preg_match_all("/<([^<]+)>/is", $OSWAP_b841d8e57855e0dee7a48e5cc871ba76, $ms); $OSWAP_dfff0d3af0185aae95a215a88122d14f[] = '<'; $OSWAP_585ebb96974e87e73e05955a2b61aae3[] = '<'; $OSWAP_dfff0d3af0185aae95a215a88122d14f[] = '>'; $OSWAP_585ebb96974e87e73e05955a2b61aae3[] = '>'; if($ms[1]) { $OSWAP_b841d8e57855e0dee7a48e5cc871ba76=preg_replace('/<!--[^!]*-->/','',$OSWAP_b841d8e57855e0dee7a48e5cc871ba76); $OSWAP_6c83bb44a2685411984749e4761763c1 = 'img|a|font|div|table|style|tbody|caption|tr|td|th|br|p|b|strong|i|u|em|span|ol|ul|li|blockquote|param|embed|h1|h2|h3|h4|h5|h6|section'; $ms[1] = array_unique($ms[1]); foreach ($ms[1] as $OSWAP_31bb5897a4cf8155e2d7054f8ef132dd) { $OSWAP_dfff0d3af0185aae95a215a88122d14f[] = "<".$OSWAP_31bb5897a4cf8155e2d7054f8ef132dd.">"; $OSWAP_31bb5897a4cf8155e2d7054f8ef132dd = shtmlspecialchars($OSWAP_31bb5897a4cf8155e2d7054f8ef132dd); $OSWAP_31bb5897a4cf8155e2d7054f8ef132dd = str_replace(array('\\','/*'), array('.','/.'), $OSWAP_31bb5897a4cf8155e2d7054f8ef132dd); $OSWAP_992fb613abd0ab3b0462aebb42788957 = array( 'onabort','onactivate','onafterprint','onafterupdate', 'onbeforeactivate','onbeforecopy','onbeforecut', 'onbeforedeactivate','onbeforeeditfocus','onbeforepaste', 'onbeforeprint','onbeforeunload','onbeforeupdate', 'onblur','onbounce','oncellchange','onchange', 'onclick','oncontextmenu','oncontrolselect', 'oncopy','oncut','ondataavailable', 'ondatasetchanged','ondatasetcomplete','ondblclick', 'ondeactivate','ondrag','ondragend', 'ondragenter','ondragleave','ondragover', 'ondragstart','ondrop','onerror','onerrorupdate', 'onfilterchange','onfinish','onfocus','onfocusin', 'onfocusout','onhelp','onkeydown','onkeypress', 'onkeyup','onlayoutcomplete','onload', 'onlosecapture','onmousedown','onmouseenter', 'onmouseleave','onmousemove','onmouseout', 'onmouseover','onmouseup','onmousewheel', 'onmove','onmoveend','onmovestart','onpaste', 'onpropertychange','onreadystatechange','onreset', 'onresize','onresizeend','onresizestart', 'onrowenter','onrowexit','onrowsdelete', 'onrowsinserted','onscroll','onselect', 'onselectionchange','onselectstart','onstart', 'onstop','onsubmit','onunload','javascript', 'script','eval','behaviour','expression' ); $OSWAP_e90d55d930eedf7bcab5e4805bc132f6 = implode('|', $OSWAP_992fb613abd0ab3b0462aebb42788957); $OSWAP_31bb5897a4cf8155e2d7054f8ef132dd = preg_replace(array("/(".$OSWAP_e90d55d930eedf7bcab5e4805bc132f6.")/i"), '.', $OSWAP_31bb5897a4cf8155e2d7054f8ef132dd); if(!preg_match("/^[\/|\s]?(".$OSWAP_6c83bb44a2685411984749e4761763c1.")(\s+|$)/is", $OSWAP_31bb5897a4cf8155e2d7054f8ef132dd)) { $OSWAP_31bb5897a4cf8155e2d7054f8ef132dd = ''; } $OSWAP_585ebb96974e87e73e05955a2b61aae3[] = empty($OSWAP_31bb5897a4cf8155e2d7054f8ef132dd)?'':"<".str_replace('"', '"', $OSWAP_31bb5897a4cf8155e2d7054f8ef132dd).">"; } } $OSWAP_b841d8e57855e0dee7a48e5cc871ba76 = str_replace($OSWAP_dfff0d3af0185aae95a215a88122d14f, $OSWAP_585ebb96974e87e73e05955a2b61aae3, $OSWAP_b841d8e57855e0dee7a48e5cc871ba76); $OSWAP_b841d8e57855e0dee7a48e5cc871ba76 = addslashes($OSWAP_b841d8e57855e0dee7a48e5cc871ba76); return $OSWAP_b841d8e57855e0dee7a48e5cc871ba76; } function cleanArray($OSWAP_a416a4b07b6f280c968f2f3bb53948d5){ $OSWAP_dd3bcccfd12c668e4296c7f6fe1cdf86=array(); foreach($OSWAP_a416a4b07b6f280c968f2f3bb53948d5 as $OSWAP_6291cc79354613208317e7b10b238055=>$OSWAP_31bb5897a4cf8155e2d7054f8ef132dd){ if(is_array($OSWAP_31bb5897a4cf8155e2d7054f8ef132dd)){ $OSWAP_dd3bcccfd12c668e4296c7f6fe1cdf86[$OSWAP_6291cc79354613208317e7b10b238055] = cleanArray($OSWAP_31bb5897a4cf8155e2d7054f8ef132dd); }else{ $OSWAP_dd3bcccfd12c668e4296c7f6fe1cdf86[$OSWAP_6291cc79354613208317e7b10b238055] = RemoveXSS($OSWAP_31bb5897a4cf8155e2d7054f8ef132dd); } } return $OSWAP_dd3bcccfd12c668e4296c7f6fe1cdf86; } function syjweb_arr_foreach($OSWAP_66189eb7098b09b18bfaa8454c4e10d2) { static $OSWAP_cf104113aea177d5d1ff1177185f8b8b; if (!is_array($OSWAP_66189eb7098b09b18bfaa8454c4e10d2)) { return $OSWAP_66189eb7098b09b18bfaa8454c4e10d2; } foreach ($OSWAP_66189eb7098b09b18bfaa8454c4e10d2 as $OSWAP_6291cc79354613208317e7b10b238055 => $OSWAP_63e29f0f36f8e0e4b3ad59487599f02a ) { if (is_array($OSWAP_63e29f0f36f8e0e4b3ad59487599f02a)) { syjweb_arr_foreach($OSWAP_63e29f0f36f8e0e4b3ad59487599f02a); } else { $OSWAP_cf104113aea177d5d1ff1177185f8b8b[] = $OSWAP_63e29f0f36f8e0e4b3ad59487599f02a; } } return implode($OSWAP_cf104113aea177d5d1ff1177185f8b8b); } function syjweb_pape(){ $OSWAP_72e05411b70e189f85d34a161e3f74ad=<<<SWAP
<html>
<head>			
<title>SYJ WEB 防火墙--SWAP MAC专版</title>
<meta charset="utf-8" />
<meta name="author" content="SYJ" />
<style>
body, h1, h2, p,dl,dd,dt{margin: 0;padding: 0;font: 12px/1.5 微软雅黑,tahoma,arial;}
body{background:#efefef;}
h1, h2, h3, h4, h5, h6 {font-size: 100%;cursor:default;}
ul, ol {list-style: none outside none;}
a {text-decoration: none;color:#447BC4}
a:hover {text-decoration: underline;}
.ip-attack{width:600px; margin:200px auto 0;}
.ip-attack dl{ background:#fff; padding:30px; border-radius:10px;border: 1px solid #CDCDCD;-webkit-box-shadow: 0 0 8px #CDCDCD;-moz-box-shadow: 0 0 8px #cdcdcd;box-shadow: 0 0 8px #CDCDCD;}
.ip-attack dt{text-align:center;}
.ip-attack dd{font-size:16px; color:#333; text-align:center;}
.tips{text-align:center; font-size:14px; line-height:50px; color:#999;}

</style>

</head>
<body>
<div class="ip-attack">
	<dl>
	 <dt><img  src='http://p2.qhimg.com/t016dd70ac04d942b1b.png' /></dt>
	 <dt><a href="javascript:history.go(-1)">返回上一页</a></dt>
	 <dt>&nbsp;</dt>
	 <dt>SWAP MAC - SYJ WEB 防火墙</dt>
	 <dt>Powered by 石蕴金</dt>
	</dl>

    </div>
   </body>
</html>
SWAP;
 echo $OSWAP_72e05411b70e189f85d34a161e3f74ad; } function syjweb_StopAttack($OSWAP_f4a8af3917da5a8386bca9cdebeaad0e,$OSWAP_7008f151ad0d1b8b3cb9dc188f2c062e,$OSWAP_3f20559a4170ef4492075e954bac8778,$OSWAP_d24d2b57d10dc1011c9eb09c5125e396) { $OSWAP_7008f151ad0d1b8b3cb9dc188f2c062e=syjweb_arr_foreach($OSWAP_7008f151ad0d1b8b3cb9dc188f2c062e); if (preg_match("/".$OSWAP_3f20559a4170ef4492075e954bac8778."/is",$OSWAP_7008f151ad0d1b8b3cb9dc188f2c062e)==1){ exit(syjweb_pape()); } if (preg_match("/".$OSWAP_3f20559a4170ef4492075e954bac8778."/is",$OSWAP_f4a8af3917da5a8386bca9cdebeaad0e)==1){ exit(syjweb_pape()); } } if ($GLOBALS['swap_mac']['config']['syjweb']['switch']) { if ($GLOBALS['swap_mac']['config']['syjweb']['get']) { foreach($_GET as $OSWAP_6291cc79354613208317e7b10b238055=>$OSWAP_31bb5897a4cf8155e2d7054f8ef132dd) { syjweb_StopAttack($OSWAP_6291cc79354613208317e7b10b238055,$OSWAP_31bb5897a4cf8155e2d7054f8ef132dd,$GLOBALS['swap_mac']['syjweb']['getfilter'],"GET"); syjweb_StopAttack($OSWAP_6291cc79354613208317e7b10b238055,$OSWAP_31bb5897a4cf8155e2d7054f8ef132dd,$GLOBALS['swap_mac']['syjweb']['phpfilter'],"GET"); } } if ($GLOBALS['swap_mac']['config']['syjweb']['post']) { foreach($_POST as $OSWAP_6291cc79354613208317e7b10b238055=>$OSWAP_31bb5897a4cf8155e2d7054f8ef132dd) { syjweb_StopAttack($OSWAP_6291cc79354613208317e7b10b238055,$OSWAP_31bb5897a4cf8155e2d7054f8ef132dd,$GLOBALS['swap_mac']['syjweb']['postfilter'],"POST"); syjweb_StopAttack($OSWAP_6291cc79354613208317e7b10b238055,$OSWAP_31bb5897a4cf8155e2d7054f8ef132dd,$GLOBALS['swap_mac']['syjweb']['phpfilter'],"POST"); } } if ($GLOBALS['swap_mac']['config']['syjweb']['cookie']) { foreach($_COOKIE as $OSWAP_6291cc79354613208317e7b10b238055=>$OSWAP_31bb5897a4cf8155e2d7054f8ef132dd) { syjweb_StopAttack($OSWAP_6291cc79354613208317e7b10b238055,$OSWAP_31bb5897a4cf8155e2d7054f8ef132dd,$GLOBALS['swap_mac']['syjweb']['cookiefilter'],"COOKIE"); } } if ($GLOBALS['swap_mac']['config']['syjweb']['referre']) { foreach($GLOBALS['swap_mac']['syjweb']['syjweb_referer'] as $OSWAP_6291cc79354613208317e7b10b238055=>$OSWAP_31bb5897a4cf8155e2d7054f8ef132dd) { syjweb_StopAttack($OSWAP_6291cc79354613208317e7b10b238055,$OSWAP_31bb5897a4cf8155e2d7054f8ef132dd,$GLOBALS['swap_mac']['syjweb']['postfilter'],"REFERRER"); } } } $_POST = cleanArray($_POST); $_GET = cleanArray($_GET); 