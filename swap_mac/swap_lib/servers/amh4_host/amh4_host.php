<?php  function amapi_host($OSWAP_e87777be5c7a474b95e3626a7e6c7025, $OSWAP_8cae87bce545a7ce4174cceb30dda597){ $OSWAP_46982c553118bf27eed2f9ef93c08339 = "amapi_pass=".$OSWAP_e87777be5c7a474b95e3626a7e6c7025["serveraccesshash"]."&amh_cmd=" . base64_encode($OSWAP_8cae87bce545a7ce4174cceb30dda597); $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, $OSWAP_e87777be5c7a474b95e3626a7e6c7025["url"]); curl_setopt($ch, CURLOPT_POST, 1); curl_setopt($ch, CURLOPT_POSTFIELDS, $OSWAP_46982c553118bf27eed2f9ef93c08339); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); $OSWAP_8f0232bc5423ea84e7d58cc177642959 = curl_exec($ch); curl_close($ch); return $OSWAP_8f0232bc5423ea84e7d58cc177642959; } function amh4_host_run($OSWAP_e87777be5c7a474b95e3626a7e6c7025,$OSWAP_8cae87bce545a7ce4174cceb30dda597){ $OSWAP_3825c6306610b3613110078d3b56626e=str_replace(array('=============================================================', ' [LNMP/Nginx] Amysql Host - AMH 4.2', 'http://Amysql.com'),'',amapi_host($OSWAP_e87777be5c7a474b95e3626a7e6c7025, $OSWAP_8cae87bce545a7ce4174cceb30dda597)); if(!$OSWAP_3825c6306610b3613110078d3b56626e) return array('ok'=>0,'text'=>'服务器连接失败'); $temp=explode('] ',$OSWAP_3825c6306610b3613110078d3b56626e); $temp=$temp[1]; $OSWAP_d4efdfa4fb6ae2e8e6c7d5f55180ebd5=explode("\n",$temp); $OSWAP_d4efdfa4fb6ae2e8e6c7d5f55180ebd5=$OSWAP_d4efdfa4fb6ae2e8e6c7d5f55180ebd5[0]; if(!$OSWAP_e87777be5c7a474b95e3626a7e6c7025["serveraccesshash"]) $OSWAP_d4efdfa4fb6ae2e8e6c7d5f55180ebd5='未填写服务器密钥'; if(strstr($OSWAP_3825c6306610b3613110078d3b56626e,'[OK]')){ return array('ok'=>1,'text'=>$OSWAP_d4efdfa4fb6ae2e8e6c7d5f55180ebd5); }else{ return array('ok'=>0,'text'=>$OSWAP_d4efdfa4fb6ae2e8e6c7d5f55180ebd5); } } function amh4_host_ConfigOptions() { $configarray = array( "默认首页" => array("Type" => "text", "Description" => "为空为默认:index.php,index.html,index.htm(填写用,号分割)"), "自定义错误页面" => array("Type" => "text", "Description" => "为空为默认:404,502"), "Rewrite规则" => array("Type" => "text", "Description" => "为空为默认:0"), "访问日志" => array( "Type" => "yesno", "Description" => "记录空间的访问日志" ), "错误日志" => array( "Type" => "yesno", "Description" => "记录空间的错误日志" ), "PHP-FPM模式" => array( "Type" => "dropdown", "Options" => "static,dynamic","Description" => "静态和动态"), "PHP-FPM数量" => array("Type" => "text",'Description'=>'为空为默认:1,2,3,3(必须填写4个参数)'), "空间限制" => array("Type" => "text",'Description'=>'为空为默认不限'), "FTP上传速度限制" => array("Type" => "text",'Description'=>'为空为默认不限'), "FTP下载速度限制" => array("Type" => "text",'Description'=>'为空为默认不限'), "FTP上传比率值" => array("Type" => "text",'Description'=>'为空为默认不限'), "FTP下载比率值" => array("Type" => "text",'Description'=>'为空为默认不限'), "FTP文件数量" => array("Type" => "text",'Description'=>'为空为默认不限'), "FTP连接并发数" => array("Type" => "text",'Description'=>'为空为默认不限') ); return $configarray; } function amh4_host_emptyarg(&$OSWAP_e87777be5c7a474b95e3626a7e6c7025) { if ($OSWAP_e87777be5c7a474b95e3626a7e6c7025["serverhostname"]) { $OSWAP_e87777be5c7a474b95e3626a7e6c7025["serverdomain"] = $OSWAP_e87777be5c7a474b95e3626a7e6c7025["serverhostname"]; } else { $OSWAP_e87777be5c7a474b95e3626a7e6c7025["serverdomain"] = $OSWAP_e87777be5c7a474b95e3626a7e6c7025["serverip"]; } if(!$OSWAP_e87777be5c7a474b95e3626a7e6c7025["serverport"]) $OSWAP_e87777be5c7a474b95e3626a7e6c7025["serverport"]='8888'; if(!$OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption1"]) $OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption1"]='index.php,index.html,index.htm'; if(!$OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption2"]) $OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption2"]='404,502'; if(!$OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption3"]) $OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption3"]='0'; $OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption4"]== 'on'?'on':'off'; $OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption5"]== 'on'?'on':'off'; if(!$OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption6"]) $OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption6"]='static'; if(!$OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption7"]) $OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption7"]='1,2,3,3'; $OSWAP_e87777be5c7a474b95e3626a7e6c7025["url"] = 'http://'.$OSWAP_e87777be5c7a474b95e3626a7e6c7025["serverdomain"].':'.$OSWAP_e87777be5c7a474b95e3626a7e6c7025["serverport"].'/index.php?c=amapi&a=call'; if(!$OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption8"]) $OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption8"]='0'; if(!$OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption9"]) $OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption9"]='0'; if(!$OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption10"]) $OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption10"]='0'; if(!$OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption11"]) $OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption11"]='0'; if(!$OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption12"]) $OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption12"]='0'; if(!$OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption13"]) $OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption13"]='0'; if(!$OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption14"]) $OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption14"]='0'; } function amh4_host_CreateAccount($OSWAP_e87777be5c7a474b95e3626a7e6c7025) { amh4_host_emptyarg($OSWAP_e87777be5c7a474b95e3626a7e6c7025); $OSWAP_8cae87bce545a7ce4174cceb30dda597 = 'amh host add '.$OSWAP_e87777be5c7a474b95e3626a7e6c7025["domain"].' '.$OSWAP_e87777be5c7a474b95e3626a7e6c7025["domain"].',www.'.$OSWAP_e87777be5c7a474b95e3626a7e6c7025["domain"].' '.$OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption1"].' '.$OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption3"].' '.$OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption2"].' '.$OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption4"].' '.$OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption5"].' '.$OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption6"].','.$OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption7"]; $OSWAP_3825c6306610b3613110078d3b56626e=amh4_host_run($OSWAP_e87777be5c7a474b95e3626a7e6c7025,$OSWAP_8cae87bce545a7ce4174cceb30dda597); if($OSWAP_3825c6306610b3613110078d3b56626e['ok']){ $OSWAP_8cae87bce545a7ce4174cceb30dda597 = 'amh ftp add '.$OSWAP_e87777be5c7a474b95e3626a7e6c7025["username"].' '.$OSWAP_e87777be5c7a474b95e3626a7e6c7025["password"].' /home/wwwroot/'.$OSWAP_e87777be5c7a474b95e3626a7e6c7025["domain"].'/web '.$OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption9"].' '.$OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption10"].' '.$OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption11"].' '.$OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption12"].' '.$OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption13"].' '.$OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption8"].' '.$OSWAP_e87777be5c7a474b95e3626a7e6c7025["configoption14"].' 0'; $OSWAP_3825c6306610b3613110078d3b56626e=amh4_host_run($OSWAP_e87777be5c7a474b95e3626a7e6c7025,$OSWAP_8cae87bce545a7ce4174cceb30dda597); if($OSWAP_3825c6306610b3613110078d3b56626e['ok']) return '成功'; else return $OSWAP_3825c6306610b3613110078d3b56626e['text']; }else return $OSWAP_3825c6306610b3613110078d3b56626e['text']; } function amh4_host_TerminateAccount($OSWAP_e87777be5c7a474b95e3626a7e6c7025) { amh4_host_emptyarg($OSWAP_e87777be5c7a474b95e3626a7e6c7025); $OSWAP_8cae87bce545a7ce4174cceb30dda597 = 'amh host del '.$OSWAP_e87777be5c7a474b95e3626a7e6c7025["domain"]; $OSWAP_3825c6306610b3613110078d3b56626e=amh4_host_run($OSWAP_e87777be5c7a474b95e3626a7e6c7025,$OSWAP_8cae87bce545a7ce4174cceb30dda597); if($OSWAP_3825c6306610b3613110078d3b56626e['ok']){ $OSWAP_8cae87bce545a7ce4174cceb30dda597 = 'amh ftp del '.$OSWAP_e87777be5c7a474b95e3626a7e6c7025["username"]; $OSWAP_3825c6306610b3613110078d3b56626e=amh4_host_run($OSWAP_e87777be5c7a474b95e3626a7e6c7025,$OSWAP_8cae87bce545a7ce4174cceb30dda597); if($OSWAP_3825c6306610b3613110078d3b56626e['ok']) return '成功'; else return $OSWAP_3825c6306610b3613110078d3b56626e['text']; }else return $OSWAP_3825c6306610b3613110078d3b56626e['text']; } function amh4_host_SuspendAccount($OSWAP_e87777be5c7a474b95e3626a7e6c7025) { amh4_host_emptyarg($OSWAP_e87777be5c7a474b95e3626a7e6c7025); $OSWAP_8cae87bce545a7ce4174cceb30dda597 = 'amh host stop '.$OSWAP_e87777be5c7a474b95e3626a7e6c7025["domain"]; $OSWAP_3825c6306610b3613110078d3b56626e=amh4_host_run($OSWAP_e87777be5c7a474b95e3626a7e6c7025,$OSWAP_8cae87bce545a7ce4174cceb30dda597); if($OSWAP_3825c6306610b3613110078d3b56626e['ok']) return '成功'; else return $OSWAP_3825c6306610b3613110078d3b56626e['text']; } function amh4_host_UnsuspendAccount($OSWAP_e87777be5c7a474b95e3626a7e6c7025) { amh4_host_emptyarg($OSWAP_e87777be5c7a474b95e3626a7e6c7025); $OSWAP_8cae87bce545a7ce4174cceb30dda597 = 'amh host start '.$OSWAP_e87777be5c7a474b95e3626a7e6c7025["domain"]; $OSWAP_3825c6306610b3613110078d3b56626e=amh4_host_run($OSWAP_e87777be5c7a474b95e3626a7e6c7025,$OSWAP_8cae87bce545a7ce4174cceb30dda597); if($OSWAP_3825c6306610b3613110078d3b56626e['ok']) return '成功'; else return $OSWAP_3825c6306610b3613110078d3b56626e['text']; } function amh4_host_ChangePassword($OSWAP_e87777be5c7a474b95e3626a7e6c7025) { amh4_host_emptyarg($OSWAP_e87777be5c7a474b95e3626a7e6c7025); $OSWAP_8cae87bce545a7ce4174cceb30dda597 = 'amh ftp pass '.$OSWAP_e87777be5c7a474b95e3626a7e6c7025["username"].' '.$OSWAP_e87777be5c7a474b95e3626a7e6c7025["password"]; $OSWAP_3825c6306610b3613110078d3b56626e=amh4_host_run($OSWAP_e87777be5c7a474b95e3626a7e6c7025,$OSWAP_8cae87bce545a7ce4174cceb30dda597); if($OSWAP_3825c6306610b3613110078d3b56626e['ok']) return '成功'; else return $OSWAP_3825c6306610b3613110078d3b56626e['text']; } function amh4_host_ClientArea($OSWAP_e87777be5c7a474b95e3626a7e6c7025) { $lang=plug_lang_get('amh4_host','','2'); return array($lang['请直接使用帐号密码进行FTP登入']); } function amh4_host_AdminLink($OSWAP_e87777be5c7a474b95e3626a7e6c7025) { amh4_host_emptyarg($OSWAP_e87777be5c7a474b95e3626a7e6c7025); if ($OSWAP_e87777be5c7a474b95e3626a7e6c7025["serverhostname"]) { $OSWAP_62274590091c95a3ab6bf0b60d6a978f = $OSWAP_e87777be5c7a474b95e3626a7e6c7025["serverhostname"]; } else { $OSWAP_62274590091c95a3ab6bf0b60d6a978f = $OSWAP_e87777be5c7a474b95e3626a7e6c7025["serverip"]; } $OSWAP_f9ff39ee8637183c3784f16f6282d807 = '<form action="http://'.$OSWAP_62274590091c95a3ab6bf0b60d6a978f.':'.$OSWAP_e87777be5c7a474b95e3626a7e6c7025["serverport"].'/index.php?c=index&a=login" target="_blank"><input type="submit" value="登录管理" /></form>'; return $OSWAP_f9ff39ee8637183c3784f16f6282d807; } 